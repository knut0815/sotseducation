function createRoseLegend(){var t=10,e=100,r=20,a=$("#roseLegendSquares").width(),n=Math.floor(a/e),s=Math.ceil(12/n),o=s*r,l=d3.select("#roseLegendSquares").append("svg").attr("width",a).attr("height",o),i=l.selectAll(".roseLegendSquare").data(roseColors).enter().append("g").attr("class","roseLegendSquare").attr("width",e).attr("height",r).attr("transform",function(t,e){return"translate("+100*Math.floor(e/s)+","+e%s*20+")"});i.append("rect").attr("width",t).attr("height",t).attr("transform","translate(10,0)").style("fill",function(t){return t}),i.append("text").attr("transform","translate("+(t+10+5)+","+t/2+")").style("text-anchor","start").attr("dy",".35em").attr("fill","#4F4F4F").style("font-size","10px").text(function(t,e){return roseProvincies[e]});var d=d3.select("#roseLegendCircles").append("svg").attr("width",$("#roseLegendCircles").width()).attr("height",$("#roseLegendCircles").height()/(mobileScreen?2:3));d.selectAll(".flowerLegend.circle").data([1,2,3]).enter().append("circle").attr("class","flowerLegend circle").attr("r",function(t){return t}).style("fill","#B5B5B5").attr("transform",function(t,e){return"translate("+(10*e+10)+",10)"}),d.append("text").attr("x",50).attr("y",10).attr("dy",".35em").style("text-anchor","start").attr("fill","#4F4F4F").style("font-size","11px").text("Geeft aan dat dit de provincie zelf is. Dit stukje is leeg gelaten en het percentage van afgestudeerden dat na 1.5 jaar in dezelfde provincie woont staat in het midden van elke plot").call(wrap,$("#roseLegendCircles").width()-60)}function drawRoses(t,e,r,a,n){function s(){$(".popover").each(function(){$(this).remove()})}function o(t,e,a){$(this).popover({placement:"auto top",container:".dataresource.rose",trigger:"manual",html:!0,content:function(){return"<span style='font-size: 11px;'><span style='color: #00A1DE; font-weight: bold;'>"+numFormatPercentDec(t.data)+"</span> verhuist van "+r[a]+" naar <span style='color: #00A1DE; font-weight: bold;'>"+r[e]+"</span></span>"}}),$(this).popover("show")}function l(t,e){flowers.append("circle").attr("class","flower circle").attr("r",t).style("fill","#B5B5B5").attr("transform",function(t,r){return t.angle=2*Math.PI/24*(2*r+1),"rotate("+(180*t.angle/Math.PI-90)+")translate("+(c+e*a)+",0)"})}function i(){chosen=d3.select(this).attr("value"),d3.select(".flowerSubTitle").text(chosen);for(x in t[chosen]){var r=d3.select("#pie"+x).selectAll("path").data(f(t[chosen][x]));r.transition().duration(1e3).attrTween("d",d)}flowers.selectAll(".flower.value").text(function(t,r,a){return numFormatPercent(e[chosen][a])})}function d(t){var e=d3.interpolate(this._current,t);return this._current=e(0),function(t){return p(e(t))}}{var c=.2*a,n=d3.scale.ordinal().domain([0,1,2,3,4,5,6,7,8,9,10,11]).range(n),u=d3.scale.linear().domain([0,.2]).range([0,1]),f=d3.layout.pie().sort(null).value(function(){return 1}).padAngle(.02),p=d3.svg.arc().innerRadius(function(t){return t.data<.002?0:c}).outerRadius(function(t){return t.data<.002?0:(a-c)*u(t.data)+c});flowers.selectAll(".solidArc.slice").data(f).enter().append("path").attr("fill",function(t,e){return n(e)}).attr("class","solidArc slice").attr("stroke","white").attr("d",p).each(function(t){this._current=t}).on("mouseover",function(t,e,r){o.call(this,t,e,r)}).on("mouseout",function(){s()})}flowers.append("text").attr("dy",".35em").style("font-size","12px").attr("class","flower titles").attr("fill","#6E6E6E").attr("text-anchor","middle").attr("transform","translate(0,"+(-a+20)+")").text(function(t,e){return"... "+r[e]});flowers.append("text").attr("class","flower value").attr("x",0).attr("y",-7).attr("text-anchor","middle").attr("dy",".35em").style("font-size","12px").text(function(t,r){return numFormatPercent(e[chosen][r])});flowers.append("text").attr("class","flower subValueText").attr("x",0).attr("y",6).attr("text-anchor","middle").attr("dy",".35em").attr("fill","#4F4F4F").style("font-size","8px").text("verhuist"),flowers.append("text").attr("class","flower subValueText").attr("x",0).attr("y",14).attr("text-anchor","middle").attr("dy",".35em").attr("fill","#4F4F4F").style("font-size","8px").text("niet"),l(1,.05),l(2,.125),l(3,.22),d3.selectAll(".roseButton").on("click",i)}var rosePadding=0,roseRadius=120,roseData={HBO:[[0,0,.021,.007,.184,.003,.003,.007,.111,.035,0,.01],[.017,0,.028,.061,.028,.011,.017,.204,.066,.088,.006,.028],[.025,.026,0,.019,.083,.003,.012,.048,.043,.011,0,.018],[.003,.009,.004,0,.002,.015,.061,.034,.051,.102,.003,.043],[.121,.009,.087,.02,0,.001,.007,.048,.032,.029,0,.02],[0,.001,.001,.027,0,0,.126,.023,.009,.017,0,.017],[.001,.003,0,.044,.001,.033,0,.026,.002,.025,.013,.066],[.001,.013,.004,.01,.006,.008,.01,0,.006,.058,.001,.046],[.015,.018,.015,.108,.016,.005,.023,.035,0,.036,.002,.055],[.002,.01,.004,.059,.001,.005,.032,.131,.015,0,.004,.076],[0,.004,0,.008,0,0,.112,.008,.008,0,0,.124],[.001,.004,.002,.01,.001,.002,.026,.057,.007,.038,.007,0]],MBO:[[0,.004,.013,.009,.106,.003,.006,.013,.062,.009,0,.004],[.004,0,.008,.038,.004,0,.01,.188,.032,.034,.002,.008],[.021,.009,0,.012,.037,.002,.001,.02,.016,.005,0,.006],[.003,.007,.003,0,0,.005,.031,.018,.042,.059,0,.014],[.073,0,.03,.011,0,0,0,.008,.011,.003,.001,.01],[0,.001,0,.012,.001,0,.068,.003,.002,.005,0,.002],[.002,0,0,.015,0,.02,0,.008,.003,.005,.009,.019],[.001,.006,.001,.011,.002,.001,.009,0,.006,.016,0,.019],[.021,.013,.004,.053,.006,.007,.007,.01,0,.016,.001,.014],[.003,.002,0,.064,.001,.003,.014,.065,.003,0,0,.027],[.002,0,0,.003,0,.002,.076,.009,.009,.003,0,.04],[.001,.001,.001,.008,.002,.001,.017,.034,.003,.022,.006,0]]},roseDiagonal={HBO:[.608,.429,.688,.663,.609,.764,.764,.818,.656,.652,.69,.83],MBO:[.764,.67,.861,.813,.844,.898,.91,.918,.844,.814,.833,.898]},chosen="HBO",roseColors=["#EFB605","#E79B01","#E35B0F","#DD092D","#C50046","#A70A61","#892E83","#604BA2","#2D6AA6","#089384","#25AE64","#7EB852"],roseProvincies=["Drenthe","Flevoland","Friesland","Gelderland","Groningen","Limburg","N. Brabant","N. Holland","Overijssel","Utrecht","Zeeland","Z. Holland"],roseWrapper=d3.select(".dataresource.rose").selectAll(".windRoses").data(roseData[chosen]).enter().append("svg").attr("class","windRoses").attr("width",2*(roseRadius+rosePadding)).attr("height",2*(roseRadius+rosePadding)).attr("id",function(t,e){return"pie"+e}),flowers=roseWrapper.append("g").attr("transform","translate("+(roseRadius+rosePadding)+","+(roseRadius+rosePadding)+")");drawRoses(roseData,roseDiagonal,roseProvincies,roseRadius,roseColors),createRoseLegend();